---

title: Downstream Analysis - Python


keywords: fastai
sidebar: home_sidebar



nb_path: "04_Tutorial_Downstream_Analysis_Python.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_Tutorial_Downstream_Analysis_Python.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now for the fun bit, wrangling the data and plotting our results! Below, we do this using pandas, matplotlib and statsmodels, and some convenience functions from <code>py_clone_detective.clone_analysis</code>.</p>
<p>First, we read in results previously generated by py_clone_detector:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/example_results.csv&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>int_img</th>
      <th>label</th>
      <th>GFP_clone</th>
      <th>GFPneg_neigh_counts</th>
      <th>GFPpos_neigh_counts</th>
      <th>total_neighbour_counts</th>
      <th>ECneg_neigh_counts</th>
      <th>ECpos_neigh_counts</th>
      <th>EEneg_neigh_counts</th>
      <th>EEpos_neigh_counts</th>
      <th>...</th>
      <th>centroid-0</th>
      <th>centroid-1</th>
      <th>eccentricity</th>
      <th>area_um2</th>
      <th>GFP_pos</th>
      <th>total_intensity</th>
      <th>EC_pos</th>
      <th>EE_pos</th>
      <th>preEC_pos</th>
      <th>ISCorEB_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1g01p1</td>
      <td>11</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>44.054696</td>
      <td>89.552116</td>
      <td>0.440881</td>
      <td>73.280625</td>
      <td>False</td>
      <td>2196457.0</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1g01p1</td>
      <td>11</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>44.054696</td>
      <td>89.552116</td>
      <td>0.440881</td>
      <td>73.280625</td>
      <td>False</td>
      <td>52757.0</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a1g01p1</td>
      <td>11</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>44.054696</td>
      <td>89.552116</td>
      <td>0.440881</td>
      <td>73.280625</td>
      <td>False</td>
      <td>2262648.0</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a1g01p1</td>
      <td>11</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>44.054696</td>
      <td>89.552116</td>
      <td>0.440881</td>
      <td>73.280625</td>
      <td>False</td>
      <td>67331.0</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a1g01p1</td>
      <td>12</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>53.590038</td>
      <td>486.798467</td>
      <td>0.465227</td>
      <td>98.690625</td>
      <td>False</td>
      <td>4113516.0</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 29 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cell-Proliferation---number-of-cells-per-clone">Cell Proliferation - number of cells per clone<a class="anchor-link" href="#Cell-Proliferation---number-of-cells-per-clone"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Out first aim is to determine whether there is a difference in the number of cells per clone. To do this, we first query an intensity image channel so that we do not count a cell (label) multiple times. Next, for simplicity, filter out columns not required for counting the number and type of cells per clone.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;int_img_ch == &quot;C1&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;clone$|pos$|int_img&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we groupby clones per image and sum to get the number of cells of each type per clone.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_df</span> <span class="o">=</span> <span class="n">count_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;int_img&quot;</span><span class="p">,</span> <span class="s2">&quot;GFP_clone&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">count_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>int_img</th>
      <th>GFP_clone</th>
      <th>GFP_pos</th>
      <th>EC_pos</th>
      <th>EE_pos</th>
      <th>preEC_pos</th>
      <th>ISCorEB_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1g01p1</td>
      <td>0</td>
      <td>0</td>
      <td>74</td>
      <td>1</td>
      <td>1</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1g01p1</td>
      <td>1</td>
      <td>14</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a1g01p1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a1g01p1</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a1g01p1</td>
      <td>4</td>
      <td>34</td>
      <td>13</td>
      <td>0</td>
      <td>0</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can add a sum all cell types per clone to get an additional 'total' column:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># simplify column names</span>
<span class="n">count_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_pos&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">count_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="c1"># drop the unneeded &quot;GFP column&quot;</span>
<span class="n">count_df</span> <span class="o">=</span> <span class="n">count_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;GFP&quot;</span><span class="p">)</span>
<span class="c1"># calculate the total cell</span>
<span class="n">count_df</span> <span class="o">=</span> <span class="n">count_df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;total = EC + preEC + EE + ISCorEB&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since where "GFP_clone" == 0, we can add an additional column stating whether a "GFP_clone" is inside a clone (<em>IC</em>) or outside a clone (<em>OC</em>):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;clone_status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;GFP_clone&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;OC&quot;</span><span class="p">,</span> <span class="s2">&quot;IC&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, the images are named 'a1' if from a wild-type (<em>ctrl</em>) animal and 'a2' if from a mutant (<em>mut</em>) animal. We can therefore add a 'genotype' column:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;genotype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;int_img&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;a1&quot;</span><span class="p">),</span> <span class="s2">&quot;ctrl&quot;</span><span class="p">,</span> <span class="s2">&quot;mut&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can groupby this genotype column and generate a stacked bar plot displaying cell numbers and types per clone. Here, we only interested in plotting cells inside clones, and so we first query on 'clone_status':</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_df_inside</span> <span class="o">=</span> <span class="n">count_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;clone_status == &quot;IC&quot;&#39;</span><span class="p">)</span>

<span class="n">inside_clone_mean</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">count_df_inside</span><span class="p">[[</span><span class="s2">&quot;genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;ISCorEB&quot;</span><span class="p">,</span> <span class="s2">&quot;preEC&quot;</span><span class="p">,</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="s2">&quot;EE&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;genotype&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">inside_clone_sem</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">count_df_inside</span><span class="p">[[</span><span class="s2">&quot;genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;ISCorEB&quot;</span><span class="p">,</span> <span class="s2">&quot;preEC&quot;</span><span class="p">,</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="s2">&quot;EE&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;genotype&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sem</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">py_clone_detective.clone_analysis</span> <span class="k">as</span> <span class="nn">ca</span>

<span class="n">ca</span><span class="o">.</span><span class="n">create_stack_bar_plot</span><span class="p">(</span>
    <span class="n">inside_clone_mean</span><span class="p">,</span>
    <span class="n">inside_clone_sem</span><span class="p">,</span>
    <span class="n">x_figSize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">color_pal</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#008b68&quot;</span><span class="p">,</span> <span class="s2">&quot;#539DC2&quot;</span><span class="p">,</span> <span class="s2">&quot;#F57171&quot;</span><span class="p">,</span> <span class="s2">&quot;#95a5a6&quot;</span><span class="p">],</span>
    <span class="n">bar_width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">y_axis_limit</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">y_label</span><span class="o">=</span><span class="s2">&quot;Cells per clone&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From this plot we can see that 'mutant' clones are on average bigger than 'ctrl' clones. This suggests that the mutation in our gene of interest may affect <strong>cell proliferation</strong>. Let do a t-test using the statsmodels library to see if this difference is significant:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;total ~ genotype&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">count_df_inside</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">lm</span><span class="o">.</span><span class="n">t_test_pairwise</span><span class="p">(</span><span class="s2">&quot;genotype&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">result_frame</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>t</th>
      <th>P&gt;|t|</th>
      <th>Conf. Int. Low</th>
      <th>Conf. Int. Upp.</th>
      <th>pvalue-hs</th>
      <th>reject-hs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mut-ctrl</th>
      <td>-9.338462</td>
      <td>1.263799</td>
      <td>-7.389196</td>
      <td>7.841122e-13</td>
      <td>-11.822504</td>
      <td>-6.854419</td>
      <td>7.841505e-13</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yes, the total number of cell per clone is significantly different in "ctrl" vs "mutant" animals.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cell-Differentiation---percentage-cell-type-inside-and-outside-clones">Cell Differentiation - percentage cell type inside and outside clones<a class="anchor-link" href="#Cell-Differentiation---percentage-cell-type-inside-and-outside-clones"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, let's investigate whether the types of cells inside and outside clones are different in ctrl and mutant animals. This information will help us determine whether our gene of interest affects <strong>cell differentiation</strong>.</p>
<p>First, since we already know that 'mutant' clones possess fewer cells than 'ctrl' clones, it is helpful to summarise cell types as a percentage.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">percentage_df</span> <span class="o">=</span> <span class="n">count_df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
    <span class="sd">&quot;&quot;&quot;EC = EC / total * 100 </span>
<span class="sd">    EE = EE / total * 100 </span>
<span class="sd">    preEC = preEC / total * 100 </span>
<span class="sd">    ISCorEB = ISCorEB / total * 100&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we plot a stacked barplot as before. However, this time we plot percentage cell types:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">percentage_df_mean</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">percentage_df</span><span class="p">[[</span><span class="s2">&quot;genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;clone_status&quot;</span><span class="p">,</span> <span class="s2">&quot;ISCorEB&quot;</span><span class="p">,</span> <span class="s2">&quot;preEC&quot;</span><span class="p">,</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="s2">&quot;EE&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;clone_status&quot;</span><span class="p">,</span> <span class="s2">&quot;genotype&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">percentage_df_sem</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">percentage_df</span><span class="p">[[</span><span class="s2">&quot;genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;clone_status&quot;</span><span class="p">,</span> <span class="s2">&quot;ISCorEB&quot;</span><span class="p">,</span> <span class="s2">&quot;preEC&quot;</span><span class="p">,</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="s2">&quot;EE&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;clone_status&quot;</span><span class="p">,</span> <span class="s2">&quot;genotype&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">sem</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ca</span><span class="o">.</span><span class="n">create_stack_bar_plot</span><span class="p">(</span>
    <span class="n">percentage_df_mean</span><span class="p">,</span>
    <span class="n">percentage_df_sem</span><span class="p">,</span>
    <span class="n">x_figSize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">color_pal</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#008b68&quot;</span><span class="p">,</span> <span class="s2">&quot;#539DC2&quot;</span><span class="p">,</span> <span class="s2">&quot;#F57171&quot;</span><span class="p">,</span> <span class="s2">&quot;#95a5a6&quot;</span><span class="p">],</span>
    <span class="n">bar_width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">y_label</span><span class="o">=</span><span class="s2">&quot;Cells per clone&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This plot suggests there might be a difference in percentage cell-types of mutant clones vs ctrl. Let's check if these differences are statistically significant.</p>
<p>To do this, we reshape our percentage data into a tidy format:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tidy_percentage_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">percentage_df</span><span class="p">,</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;clone_status&quot;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="s2">&quot;preEC&quot;</span><span class="p">,</span> <span class="s2">&quot;EE&quot;</span><span class="p">,</span> <span class="s2">&quot;ISCorEB&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;cell_type&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;perc_cell_num&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tidy_percentage_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genotype</th>
      <th>clone_status</th>
      <th>cell_type</th>
      <th>perc_cell_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ctrl</td>
      <td>OC</td>
      <td>EC</td>
      <td>42.045455</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ctrl</td>
      <td>IC</td>
      <td>EC</td>
      <td>64.285714</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ctrl</td>
      <td>IC</td>
      <td>EC</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ctrl</td>
      <td>IC</td>
      <td>EC</td>
      <td>25.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ctrl</td>
      <td>IC</td>
      <td>EC</td>
      <td>38.235294</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We then create a composite column that contains genotype (g), clone_status (cs) and cell_type (ct) information.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;comp_g_cs_ct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;genotype&quot;</span><span class="p">]</span>
    <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
    <span class="o">+</span> <span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;clone_status&quot;</span><span class="p">]</span>
    <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
    <span class="o">+</span> <span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;cell_type&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">tidy_percentage_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;comp_g_cs_ct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;comp_g_cs_ct&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="s2">&quot;category&quot;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using statsmodels and patsy, we set up a ContrastMatrix for our desired comparisons.</p>
<p>Our first set of contrasts compares the percentage of each cell type <u>inside mutant vs ctrl</u> clones:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">contrasts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;mut_IC_EC-ctrl_IC_EC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mut_IC_EE-ctrl_IC_EE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mut_IC_preEC-ctrl_IC_preEC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mut_IC_ISCorEB-ctrl_IC_ISCorEB&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would also like to compare the percentage of each cell type <u>outside mutant vs inside mutant</u> clones.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">contrasts</span> <span class="o">=</span> <span class="n">contrasts</span> <span class="o">+</span> <span class="p">[</span>
    <span class="s2">&quot;mut_OC_EC-mut_IC_EC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mut_OC_EE-mut_IC_EE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mut_OC_preEC-mut_IC_preEC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mut_OC_ISCorEB-mut_IC_ISCorEB&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is a helper function to construct the values of contrast matrix:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create_contrast_matrix</span><span class="p">(</span><span class="n">desired_contrasts</span><span class="p">,</span> <span class="n">df_column</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df_column</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">contrast</span> <span class="ow">in</span> <span class="n">desired_contrasts</span><span class="p">:</span>
        <span class="n">group_A</span><span class="p">,</span> <span class="n">group_B</span> <span class="o">=</span> <span class="n">contrast</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">levels</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="n">group_A</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">group_B</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now setup a custom contrast matrix using patsy:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="n">create_contrast_matrix</span><span class="p">(</span><span class="n">contrasts</span><span class="p">,</span> <span class="n">tidy_percentage_df</span><span class="p">[</span><span class="s2">&quot;comp_g_cs_ct&quot;</span><span class="p">])</span>

<span class="kn">from</span> <span class="nn">patsy.contrasts</span> <span class="kn">import</span> <span class="n">ContrastMatrix</span>

<span class="n">c_matrix</span> <span class="o">=</span> <span class="n">ContrastMatrix</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span> <span class="n">column_suffixes</span><span class="o">=</span><span class="n">contrasts</span><span class="p">)</span>
<span class="n">c_matrix</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ContrastMatrix(array([[ 1,  0,  0,  0,  0,  0,  0,  0],
                      [ 0,  1,  0,  0,  0,  0,  0,  0],
                      [ 0,  0,  0,  1,  0,  0,  0,  0],
                      [ 0,  0,  1,  0,  0,  0,  0,  0],
                      [ 0,  0,  0,  0,  0,  0,  0,  0],
                      [ 0,  0,  0,  0,  0,  0,  0,  0],
                      [ 0,  0,  0,  0,  0,  0,  0,  0],
                      [ 0,  0,  0,  0,  0,  0,  0,  0],
                      [-1,  0,  0,  0,  1,  0,  0,  0],
                      [ 0, -1,  0,  0,  0,  1,  0,  0],
                      [ 0,  0,  0, -1,  0,  0,  0,  1],
                      [ 0,  0, -1,  0,  0,  0,  1,  0],
                      [ 0,  0,  0,  0, -1,  0,  0,  0],
                      [ 0,  0,  0,  0,  0, -1,  0,  0],
                      [ 0,  0,  0,  0,  0,  0,  0, -1],
                      [ 0,  0,  0,  0,  0,  0, -1,  0]]),
               [&#39;mut_IC_EC-ctrl_IC_EC&#39;,
                &#39;mut_IC_EE-ctrl_IC_EE&#39;,
                &#39;mut_IC_preEC-ctrl_IC_preEC&#39;,
                &#39;mut_IC_ISCorEB-ctrl_IC_ISCorEB&#39;,
                &#39;mut_OC_EC-mut_IC_EC&#39;,
                &#39;mut_OC_EE-mut_IC_EE&#39;,
                &#39;mut_OC_preEC-mut_IC_preEC&#39;,
                &#39;mut_OC_ISCorEB-mut_IC_ISCorEB&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we construct a 'ordinary least squares' (ols) model using statsmodels and test our desired contrasts:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;perc_cell_num ~ C(comp_g_cs_ct, c_matrix) -1&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tidy_percentage_df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">lm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>perc_cell_num</td>  <th>  R-squared (uncentered):</th>      <td>   0.371</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared (uncentered):</th> <td>   0.368</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th>          <td>   145.5</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 20 Aug 2021</td> <th>  Prob (F-statistic):</th>          <td>1.70e-192</td>
</tr>
<tr>
  <th>Time:</th>                 <td>10:24:25</td>     <th>  Log-Likelihood:    </th>          <td> -9819.2</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1984</td>      <th>  AIC:               </th>          <td>1.965e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  1976</td>      <th>  BIC:               </th>          <td>1.970e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     8</td>      <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
                             <td></td>                                <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_IC_EC-ctrl_IC_EC</th>           <td>   29.1730</td> <td>    2.286</td> <td>   12.764</td> <td> 0.000</td> <td>   24.691</td> <td>   33.655</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_IC_EE-ctrl_IC_EE</th>           <td>    0.8552</td> <td>    2.286</td> <td>    0.374</td> <td> 0.708</td> <td>   -3.627</td> <td>    5.338</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_IC_preEC-ctrl_IC_preEC</th>     <td>   -0.1374</td> <td>    2.286</td> <td>   -0.060</td> <td> 0.952</td> <td>   -4.620</td> <td>    4.345</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_IC_ISCorEB-ctrl_IC_ISCorEB</th> <td>   31.3617</td> <td>    2.286</td> <td>   13.722</td> <td> 0.000</td> <td>   26.879</td> <td>   35.844</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_OC_EC-mut_IC_EC</th>            <td>   37.5837</td> <td>    2.897</td> <td>   12.973</td> <td> 0.000</td> <td>   31.902</td> <td>   43.265</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_OC_EE-mut_IC_EE</th>            <td>    5.5933</td> <td>    2.897</td> <td>    1.931</td> <td> 0.054</td> <td>   -0.088</td> <td>   11.275</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_OC_preEC-mut_IC_preEC</th>      <td>    0.0680</td> <td>    2.897</td> <td>    0.023</td> <td> 0.981</td> <td>   -5.614</td> <td>    5.750</td>
</tr>
<tr>
  <th>C(comp_g_cs_ct, c_matrix)mut_OC_ISCorEB-mut_IC_ISCorEB</th>  <td>   85.7179</td> <td>    2.897</td> <td>   29.587</td> <td> 0.000</td> <td>   80.036</td> <td>   91.400</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>693.593</td> <th>  Durbin-Watson:     </th> <td>   1.297</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>2587.281</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.700</td>  <th>  Prob(JB):          </th> <td>    0.00</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.442</td>  <th>  Cond. No.          </th> <td>    2.44</td>
</tr>
</table><br/><br/>Notes:<br/>[1] RÂ² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Alternative approach:</strong><br>
If we did not have specific contrast we were interested, we could perform FDR adjusted pairwise t-tests for all possible comparisons:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;perc_cell_num ~ comp_g_cs_ct&quot;</span><span class="p">,</span> <span class="n">tidy_percentage_df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">stat_df</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">t_test_pairwise</span><span class="p">(</span><span class="s2">&quot;comp_g_cs_ct&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fdr_bh&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">result_frame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># clean up column names</span>
<span class="n">stat_df</span> <span class="o">=</span> <span class="n">stat_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;comparisons&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue-fdr_bh&quot;</span><span class="p">:</span> <span class="s2">&quot;pvalue_fdr_bh&quot;</span><span class="p">,</span> <span class="s2">&quot;reject-fdr_bh&quot;</span><span class="p">:</span><span class="s2">&quot;reject_fdr_bh&quot;</span><span class="p">}</span>
<span class="p">)</span>

<span class="n">stat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comparisons</th>
      <th>coef</th>
      <th>std err</th>
      <th>t</th>
      <th>P&gt;|t|</th>
      <th>Conf. Int. Low</th>
      <th>Conf. Int. Upp.</th>
      <th>pvalue_fdr_bh</th>
      <th>reject_fdr_bh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ctrl_IC_EE-ctrl_IC_EC</td>
      <td>-38.305810</td>
      <td>2.294371</td>
      <td>-16.695562</td>
      <td>1.255696e-58</td>
      <td>-42.805461</td>
      <td>-33.806158</td>
      <td>9.417720e-58</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ctrl_IC_ISCorEB-ctrl_IC_EC</td>
      <td>15.114012</td>
      <td>2.294371</td>
      <td>6.587432</td>
      <td>5.726200e-11</td>
      <td>10.614360</td>
      <td>19.613663</td>
      <td>1.090705e-10</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ctrl_IC_preEC-ctrl_IC_EC</td>
      <td>-40.919283</td>
      <td>2.294371</td>
      <td>-17.834642</td>
      <td>4.545324e-66</td>
      <td>-45.418934</td>
      <td>-36.419631</td>
      <td>4.545324e-65</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ctrl_OC_EC-ctrl_IC_EC</td>
      <td>0.342318</td>
      <td>4.210434</td>
      <td>0.081302</td>
      <td>9.352098e-01</td>
      <td>-7.915060</td>
      <td>8.599696</td>
      <td>9.510608e-01</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ctrl_OC_EE-ctrl_IC_EC</td>
      <td>-36.421580</td>
      <td>4.210434</td>
      <td>-8.650314</td>
      <td>1.047014e-17</td>
      <td>-44.678958</td>
      <td>-28.164202</td>
      <td>2.617535e-17</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Filtering to look at our favourite comparisons:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stat_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;comparisons in @contrasts&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comparisons</th>
      <th>coef</th>
      <th>std err</th>
      <th>t</th>
      <th>P&gt;|t|</th>
      <th>Conf. Int. Low</th>
      <th>Conf. Int. Upp.</th>
      <th>pvalue_fdr_bh</th>
      <th>reject_fdr_bh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>mut_IC_EC-ctrl_IC_EC</td>
      <td>-22.738055</td>
      <td>2.196693</td>
      <td>-10.351040</td>
      <td>1.736493e-24</td>
      <td>-27.046143</td>
      <td>-18.429967</td>
      <td>6.128799e-24</td>
      <td>True</td>
    </tr>
    <tr>
      <th>22</th>
      <td>mut_IC_EE-ctrl_IC_EE</td>
      <td>3.571779</td>
      <td>2.196693</td>
      <td>1.625980</td>
      <td>1.041139e-01</td>
      <td>-0.736309</td>
      <td>7.879868</td>
      <td>1.388186e-01</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>mut_IC_ISCorEB-ctrl_IC_ISCorEB</td>
      <td>18.864522</td>
      <td>2.196693</td>
      <td>8.587692</td>
      <td>1.773340e-17</td>
      <td>14.556434</td>
      <td>23.172611</td>
      <td>4.342875e-17</td>
      <td>True</td>
    </tr>
    <tr>
      <th>49</th>
      <td>mut_IC_preEC-ctrl_IC_preEC</td>
      <td>0.301753</td>
      <td>2.196693</td>
      <td>0.137367</td>
      <td>8.907546e-01</td>
      <td>-4.006335</td>
      <td>4.609842</td>
      <td>9.135945e-01</td>
      <td>False</td>
    </tr>
    <tr>
      <th>95</th>
      <td>mut_OC_EC-mut_IC_EC</td>
      <td>14.177692</td>
      <td>4.212662</td>
      <td>3.365495</td>
      <td>7.787462e-04</td>
      <td>5.915945</td>
      <td>22.439440</td>
      <td>1.139629e-03</td>
      <td>True</td>
    </tr>
    <tr>
      <th>102</th>
      <td>mut_OC_EE-mut_IC_EE</td>
      <td>-0.856115</td>
      <td>4.212662</td>
      <td>-0.203224</td>
      <td>8.389808e-01</td>
      <td>-9.117862</td>
      <td>7.405633</td>
      <td>8.831377e-01</td>
      <td>False</td>
    </tr>
    <tr>
      <th>108</th>
      <td>mut_OC_ISCorEB-mut_IC_ISCorEB</td>
      <td>-14.296138</td>
      <td>4.212662</td>
      <td>-3.393611</td>
      <td>7.034477e-04</td>
      <td>-22.557885</td>
      <td>-6.034391</td>
      <td>1.042145e-03</td>
      <td>True</td>
    </tr>
    <tr>
      <th>113</th>
      <td>mut_OC_preEC-mut_IC_preEC</td>
      <td>0.974560</td>
      <td>4.212662</td>
      <td>0.231341</td>
      <td>8.170742e-01</td>
      <td>-7.287187</td>
      <td>9.236308</td>
      <td>8.676894e-01</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

